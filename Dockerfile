# The base image for our Docker image it will be Python
# From the Python base we'll include the tools needed (we'll use for this image Python 3.7)
FROM python:3.7-stretch

# Labels
LABEL "maintainer"="Vicente Ruben Del Pino Ruiz (https://www.linkedin.com/in/vrdelpino/)"

####################################################################################################
####################################################################################################
##                           Copy Scripts to initialize system                                    ##
####################################################################################################
####################################################################################################
# Create directories for notebooks
RUN mkdir -p quantum_studio/data

# Copy the start-services script
COPY scripts/start-environment.sh /start-environment.sh
COPY requirements/requirements.txt /requirements.txt
COPY configuration/jupyter_notebook_config.json /jupyter_notebook_config.json

RUN chmod 777 /start-environment.sh
RUN chmod 777 /requirements.txt
RUN chmod 777 /jupyter_notebook_config.json

####################################################################################################
####################################################################################################
##                                INSTALL Python Dependencies                                     ##
####################################################################################################
####################################################################################################
RUN pip install --upgrade pip
RUN pip install -r requirements.txt

####################################################################################################
####################################################################################################
##                                    Install NBExtensions                                        ##
##                            Enable Dark Mode in Jupyter Notebook                                ##
####################################################################################################
####################################################################################################
RUN jupyter contrib nbextension install --system
RUN jt -t onedork -fs 95 -altp -tfs 11 -nfs 115 -cellw 88% -T

#################################################################################################
#################################################################################################
##                               EXPOSE Jupyter Notebook Port                                  ##
#################################################################################################
#################################################################################################
# Expose the Jupyter Notebook port
EXPOSE 8080

##############################################################################################################
##############################################################################################################
##                                         START THE SYSTEM                                                 ##
##############################################################################################################
##############################################################################################################
# Execute the commands needed
CMD ["/start-environment.sh"]